!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Yngwie=e():t.Yngwie=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Controller:()=>o,Element:()=>i,Error:()=>r,Node:()=>n,TextNode:()=>s,Transform:()=>a});class r extends Error{constructor(t,e){super(t),this.data=`${e}`}log(){console.log(this.stack),console.log("What Failed: ",this.data)}}class n{constructor(t){if("string"!=typeof t)throw new r("Value of YngwieNode must be STRING",t);this._value=t,this._parent=void 0,this._first=void 0,this._last=void 0,this._next=void 0,this._prev=void 0}children(){let t=this._first,e=[];for(;t;)e.push(t),t=t._next;return e}append(t){if(t instanceof n)return t._parent&&t.detach(),void 0!==this._first?(t._prev=this._last,this._last._next=t,this._last=t):(this._first=t,this._last=t),t._parent=this,this;throw new r("Can only apppend YngwieNode to other YngwieNodes",t)}appends(t){if(t instanceof Array)return t.reduce(((t,e)=>this.append(e)),this);throw new r("Expected array as arguemnt",t)}detach(){return this._prev?this._prev._next=this._next:this._parent&&(this._parent._first=this._next),this._next&&(this._next._prev=this._prev),this._next=void 0,this._prev=void 0,this._parent=void 0,this}insertBefore(t){if(t instanceof n)return t._prev=this._prev,t._next=this,t._parent=this._parent,this._prev?this._prev._next=t:this._parent&&(this._parent._first=t),this._prev=t,this;throw new r("Can only insert a YngwieNode before other YngwieNodes",t)}replaceWith(t){if(t instanceof n){if(void 0!==this._parent)return this.insertBefore(t),this.detach(),t;throw new r("Can only replace YngwieNode if YngwieNode being replaced has parent",this)}throw new r("Can only replace a YngwieNode with another YngwieNode",t)}clone(){let t=`${this._value}`,e=new n(t);return this.children().reduce(((t,r)=>(e=r.clone(),t.append(e))),e)}step(t,e){return next=t(this,e),next&&next.step(t,e),e}parse(t,e){return n.parse(this,(r=>{e=t(r,e)})),e}static init(t){return new n(t)}static parse(t,e){if(!(t instanceof n))throw new r("Can only parse a YngwieNode",t);for(e(t),t=t._first;t;)n.parse(t,e),t=t._next}}class i extends n{constructor(t,e,r,n){super(t.toUpperCase()),this._attribs=e||{},this._text=r,this._controllers=[]}tagName(){return this._value}attribs(t){if(void 0===t)return this._attribs;if("object"==typeof t)return this._attribs=t,this;throw new r("YngwieElement attributes can only be set with OBJECT",t)}hasAttribute(t){return this._attribs.hasOwnProperty(t)}getAttribute(t){return this._attribs[t]}setAttribute(t,e){return this._attribs[t]=e,this}removeAttribute(t){return delete this._attribs[t],this}text(t){if(void 0===t)return this._text;if("string"==typeof t)return this._text=t,this;throw new r("Text of element can only be set with a STRING",t)}removeText(){return this._text=void 0,this}getElementsBy(t){return this.parse(((e,r)=>(e instanceof i&&!0===t(e)&&r.push(e),r)),[])}getElementsByTagName(t){return this.getElementsBy((e=>e.tagName()===t))}getElementsByAttribute(t,e){return this.getElementsBy((r=>!!r.hasAttribute(t)&&(void 0===e||r.getAttribute(t)===e)))}getElementsByClass(t){return this.getElementsByAttribute("class",t)}getElementByID(t){return this.getElementsByAttribute("id",t).pop()}on(t,e){let r=Yngwie.Controller.init(t,e);return this._controllers.push(r),this}clone(){let t=`${this._value}`,e=Object.keys(this._attribs).reduce(((t,e)=>(t[e]=`${this._attribs[e]}`,t)),{}),r=void 0!==this._text?`${this._text}`:void 0,n=this._controllers.map((t=>t.clone())),s=new i(t,e,r,n);return this.children().reduce(((t,e)=>(e=e.clone(),t.append(e))),s)}render(t,e){let r=void 0===e?document:e,n=Object.keys(this._attribs).reduce(((t,e)=>(t.setAttribute(e,this._attribs[e]),t)),r.createElement(this._value));if(n=this._controllers.reduce(((t,e)=>e.render(t,this)),n),"string"==typeof this._text){let t=r.createTextNode(this._text);n.appendChild(t)}let i=this.children().reduce(((t,e)=>(e=e.render(),t.appendChild(e),t)),n);return void 0!==t&&("string"==typeof t?r.querySelector(t).appendChild(i):t.appendChild(i)),i}static init(t,e,r,n){return new i(t,e,r,n)}static renderTo(t,e,n){let s=void 0===n?document:n;if(e instanceof Array){let n="string"==typeof t?s.querySelector(t):t;return e.reduce(((t,e)=>{if(e instanceof i)return e.render(t),t;throw new r("Only YngwieElement can be rendered to target",e)}),n)}throw new r("Expected array as argument",e)}static inject(t,e,n){if(e instanceof i){let r=void 0===n?document:n,i="string"==typeof t?r.querySelector(t):t,s=e.render();return i.replaceWith(s),i}throw new r("Only YngwieElement can be injected into target",e)}}class s extends n{constructor(t){super(t)}text(){return this._value}append(t){if("string"==typeof t)return this._value+=t,this;if(t instanceof s)return this._value+=t.text(),this;throw new r("Only STRINGs and other YngwieTextNodes can append a YngwieTextNode",t)}render(t,e){let r=void 0===e?document:e,n=r.createTextNode(this._value);return void 0!==t&&("string"==typeof t&&r.querySelector(t),t.appendChild(n)),n}clone(){return new s(`${this._value}`)}static init(t){return new s(t)}}class o{constructor(t,e){this._evtName=t,this._fns=e||[]}add(t){return this._fns.push(t),this}clone(){let t=`${this._evtName}`,e=this._fns.map((t=>t.toString()));return new o(t,e)}render(t,e){return this._fns.reduce(((t,r)=>(t.addEventListener(this._evtName,(function(n){r.call(void 0===e?t:e,n,t)})),t)),t)}static init(t,e){return void 0!==e?new o(t,!0===Array.isArray(e)?e:[e]):new o(t)}}class a{constructor(t){this._value=t,this._type=a.getType(t)}toNODE(){switch(this._type){case"NODE":return this._value;case"STRING":return(new DOMParser).parseFromString(this._value,"text/html").body.firstChild;case"YNGWIE":return this._value.render();default:throw new a("Cannot transform to NODE from unsuppoted type",this._value)}}toSTRING(){switch(this._type){case"NODE":return 1===this._value.nodeType?this._value.outerHTML:this._value.nodeValue;case"STRING":return this._value;case"YNGWIE":console.log(this._value);let t=this._value.render();return console.log(t),1===t.nodeType?t.outerHTML:t.nodeValue;default:throw new a("Cannot transform to STRING from unsuppoted type",this._value)}}toYNGWIE(){switch(this._type){case"NODE":case"STRING":return a.init(this._value);case"YNGWIE":return this._value;default:throw new a("Cannot transform to YngwieElement from unsuppoted type",this._value)}}static init(t){return h("STRING"===a.getType(t)?a.toNODE(t):t)}static toNODE(t){return new a(t).toNODE()}static toSTRING(t){return new a(t).toSTRING()}static toYNGWIE(t){return new a(t).toYNGWIE()}static getType(t){return t instanceof Node?"NODE":"string"==typeof t?"STRING":t instanceof n?"YNGWIE":void 0}}function h(t,e){if(1===t.nodeType){let r=function(t){return Array.from(t.attributes).reduce(((t,e)=>(t[e.name]=e.value,t)),{})}(t),n=new i(t.tagName,r);e=void 0===e?n:e.append(n)}if(3===t.nodeType){let r=new s(t.nodeValue);e=void 0===e?r:e.append(r)}for(t=t.firstChild;t;){let r=h(t);void 0!==r&&e.append(r),t=t.nextSibling}return e}return e})()}));